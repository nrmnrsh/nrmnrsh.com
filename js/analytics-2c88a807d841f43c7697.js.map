{"version":3,"sources":["webpack:///./components/analytics/actions/Initialize.js","webpack:///./components/analytics/actions/TrackEvent.js","webpack:///./components/analytics/services/Scrolldepth.js","webpack:///./utils/debounce/index.js","webpack:///./components/analytics/services/Registry.js"],"names":["_TrackEvent","__webpack_require__","_Scrolldepth","_Registry","ANALYTICS_INTIAL_CALLS","NAMESPACE","EVENT_TRACKEVENT","VALUE_NONINTERACTION_TRUE","nonInteraction","VALUE_NONINTERACTION_FALSE","__getPathname","window","location","pathname","__getParentElement","el","selector","all","document","querySelectorAll","current","includes","parentElement","Action","this","_load","_setup","script","createElement","ga","q","push","Array","apply","arguments","l","Date","GoogleAnalyticsObject","async","src","head","appendChild","forEach","args","context","registry","Registry","trackEventType","actions","add","TrackEvent","values","Scrolldepth","registerEvent","category","action","label","value","data","percentage","body","addEventListener","event","target","trigger","href","_ref","concat","Error","_typeof","constructor","Object","isArray","_debounce","PERCENTAGE_TRIGGERS","options","_classCallCheck","reset","_onScroll","debounce","bind","removeEventListener","_percentage","_triggers","_this","doc","html","documentElement","viewportHeight","Math","max","clientHeight","innerHeight","documentHeight","scrollHeight","offsetHeight","pageYOffset","length","filter","update","func","delay","inDebounce","_len","_key","self","clearTimeout","setTimeout","EventMapper","undefined","_mappings","_onEvent","fromType","toType","dataMapping","mappings","on","type","mapping","_build","source","_this2","keys","key","indexOf","substr","call","execute","_extends","_this3","_possibleConstructorReturn","__proto__","getPrototypeOf","map"],"mappings":"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","file":"analytics-2c88a807d841f43c7697.js","sourcesContent":["import {Action as TrackEvent} from 'components/analytics/actions/TrackEvent';\nimport {Scrolldepth} from 'components/analytics/services/Scrolldepth';\nimport {Registry} from 'components/analytics/services/Registry';\n\n\nconst\n\tANALYTICS_PROPERTY = 'UA-17711526-1',\n\tANALYTICS_SOURCE = 'https://www.google-analytics.com/analytics.js',\n\tANALYTICS_INTIAL_CALLS = [\n\t\t['set', 'anonymizeIp', true],\n\t\t['send', 'pageview']\n\t],\n\tNAMESPACE = 'analytics:',\n\tNAMESPACE_REGISTRY = NAMESPACE + 'registry',\n\tEVENT_TRACKEVENT = NAMESPACE + 'trackevent',\n\tVALUE_NONINTERACTION_TRUE = {\n\t\tnonInteraction: true\n\t},\n\tVALUE_NONINTERACTION_FALSE =  {\n\t\tnonInteraction: false\n\t}\n;\n\n\nfunction __getPathname() {\n\treturn window.location.pathname;\n}\n\nfunction __getParentElement(el, selector) {\n\tconst all = [...document.querySelectorAll(selector)];\n\tlet current = el;\n\n\twhile (current) {\n\t\tif (all.includes(current)) {\n\t\t\treturn current;\n\t\t}\n\t\tcurrent = current.parentElement;\n\t}\n\n\treturn null;\n}\n\n\nexport class Action {\n\n\trun() {\n\t\tthis._load();\n\t\tthis._setup();\n\t}\n\n\t_load() {\n\t\tconst\n\t\t\tscript = document.createElement('script'),\n\t\t\tga = window.ga || function() {\n\t\t\t\t(ga.q = ga.q || []).push(Array.apply(null, arguments));\n\t\t\t}\n\t\t;\n\t\tga.l = 1 * new Date();\n\t\twindow.GoogleAnalyticsObject = 'ga';\n\t\twindow.ga = ga;\n\n\t\tscript.async = true;\n\t\tscript.src = ANALYTICS_SOURCE;\n\t\tdocument.head.appendChild(script);\n\n\t\tga('create', ANALYTICS_PROPERTY, 'auto');\n\t\tANALYTICS_INTIAL_CALLS.forEach(args => ga.apply(null, args));\n\t}\n\n\t_setup() {\n\t\tconst\n\t\t\t{context} = this,\n\t\t\tregistry = new Registry({context, trackEventType: EVENT_TRACKEVENT})\n\t\t;\n\n\t\tcontext.actions.add(EVENT_TRACKEVENT, TrackEvent);\n\t\tcontext.values.add(NAMESPACE_REGISTRY, registry);\n\n\t\t// Register events from the scrolldepth service:\n\t\tnew Scrolldepth({context});\n\t\tregistry.registerEvent('scrolldepth:percentage', {\n\t\t\tcategory: 'scrolldepth',\n\t\t\taction: '.percentage',\n\t\t\tlabel: __getPathname,\n\t\t\tvalue: (data) => {\n\t\t\t\treturn data.percentage < 75 ?\n\t\t\t\t\tVALUE_NONINTERACTION_TRUE :\n\t\t\t\t\tVALUE_NONINTERACTION_FALSE;\n\t\t\t}\n\t\t});\n\n\t\t// Register global click handler to catch click events for specific\n\t\t// elements. Do not attach clickhandlers directly to the selector\n\t\t// because the singlepage behaviour will result in lost references and\n\t\t// new elements won't be attached.\n\t\tdocument.body.addEventListener('click', (event) => {\n\t\t\t// Track outbound links:\n\t\t\tconst el = __getParentElement(event.target, '[href^=\"http\"]');\n\t\t\tif (el) {\n\t\t\t\tcontext.trigger(EVENT_TRACKEVENT, {\n\t\t\t\t\tcategory: 'outbound',\n\t\t\t\t\taction: 'click',\n\t\t\t\t\tlabel: el.href,\n\t\t\t\t\tvalue: VALUE_NONINTERACTION_TRUE\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\t}\n\n}\n","export class Action {\n\n\trun() {\n\t\tconst\n\t\t\t{action, category, label, value} = this.event.data || {},\n\t\t\targs = ['send', 'event', category, action]\n\t\t\t\t.concat(label ? [label] : [])\n\t\t\t\t.concat(value ? [value] : [])\n\t\t;\n\n\t\tif (!action || !category) {\n\t\t\tthrow new Error('Missing action or category for event tracking.');\n\t\t}\n\n\t\tif (value && !label) {\n\t\t\tthrow new Error('Missing label for value for event tracking.');\n\t\t}\n\n\t\tif (value &&\n\t\t\ttypeof value !== 'number' &&\n\t\t\ttypeof value !== 'object' &&\n\t\t\tvalue.constructor !== Object ||\n\t\t\tArray.isArray(value)) {\n\t\t\tthrow new Error('Value for event tracking must be a number or object.');\n\t\t}\n\n\t\twindow.ga.apply(null, args);\n\t}\n\n}\n","import {debounce} from 'utils/debounce';\n\n\nconst\n\tEVENT_TYPE = 'scrolldepth:percentage',\n\tPERCENTAGE_TRIGGERS = [25, 50, 75, 100]\n;\n\n\nexport class Scrolldepth {\n\n\tconstructor(options) {\n\t\tthis.options = options;\n\t\tthis.context = options.context;\n\t\tthis.reset();\n\n\t\tthis._onScroll = debounce(this._onScroll.bind(this), 250);\n\t\twindow.addEventListener('scroll', this._onScroll);\n\t}\n\n\tdestroy() {\n\t\twindow.removeEventListener('scroll', this._onScroll);\n\t}\n\n\treset() {\n\t\tthis._percentage = 0;\n\t\tthis._triggers = [].concat(PERCENTAGE_TRIGGERS);\n\t}\n\n\tupdate() {\n\t\tconst\n\t\t\t// References:\n\t\t\tdoc = document,\n\t\t\thtml = doc.documentElement,\n\t\t\tbody = doc.body,\n\t\t\tvalues = [],\n\n\t\t\t// Dimensions:\n\t\t\tviewportHeight = Math.max(\n\t\t\t\thtml.clientHeight,\n\t\t\t\twindow.innerHeight || 0\n\t\t\t),\n\t\t\tdocumentHeight = Math.max(\n\t\t\t\tbody.scrollHeight,\n\t\t\t\tbody.offsetHeight,\n\t\t\t\thtml.clientHeight,\n\t\t\t\thtml.scrollHeight,\n\t\t\t\thtml.offsetHeight,\n\t\t\t\twindow.clientHeight || 0 // For testing\n\t\t\t),\n\t\t\tscrollTop = window.pageYOffset,\n\n\t\t\t// Calculation:\n\t\t\tpercentage = scrollTop / (documentHeight - viewportHeight) * 100\n\t\t;\n\n\t\tif (percentage !== this._percentage) {\n\t\t\tthis._percentage = percentage;\n\n\t\t\tthis._triggers.forEach((trigger) => {\n\t\t\t\t// Push trigger from available list into list of trigger values\n\t\t\t\t// which will be fired.\n\t\t\t\tif (percentage >= trigger) {\n\t\t\t\t\tvalues.push(trigger);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (values.length) {\n\t\t\t\t// Remove triggers to be fired from available list:\n\t\t\t\tthis._triggers = this._triggers.filter((trigger) =>\n\t\t\t\t\t!values.includes(trigger));\n\n\t\t\t\t// Notify into context collected triggers:\n\t\t\t\tvalues.forEach((trigger) =>\n\t\t\t\t\tthis.context.trigger(EVENT_TYPE, {percentage: trigger}));\n\t\t\t}\n\t\t}\n\t}\n\n\t_onScroll() {\n\t\tthis.update();\n\t}\n\n}\n","// See: https://codeburst.io/throttling-and-debouncing-in-javascript-b01cad5c8edf\nexport function debounce(func, delay) {\n\tlet inDebounce;\n\treturn function(...args) {\n\t\tconst self = this;\n\t\twindow.clearTimeout(inDebounce);\n\t\tinDebounce = setTimeout(() => func.apply(self, args), delay);\n\t};\n}\n","class EventMapper {\n\n\tconstructor(options = {}) {\n\t\tif (!options.context) {\n\t\t\tthrow new Error('Missing context in event mapper options.');\n\t\t}\n\n\t\tthis.options = options;\n\t\tthis.context = options.context;\n\t\tthis._mappings = {};\n\t\tthis._onEvent = this._onEvent.bind(this);\n\t}\n\n\tget mappings() {\n\t\treturn {...this._mappings};\n\t}\n\n\tmap(fromType, toType, dataMapping = {}) {\n\t\tconst mappings = this._mappings[fromType] || [];\n\n\t\tif (mappings.length === 0) {\n\t\t\tthis.context.on(fromType, this._onEvent);\n\t\t}\n\n\t\tmappings.push({toType, dataMapping});\n\t\tthis._mappings[fromType] = mappings;\n\t}\n\n\texecute(event) {\n\t\tconst mappings = this._mappings[event.type] || [];\n\n\t\tmappings.forEach((mapping) => {\n\t\t\tconst {toType, dataMapping} = mapping;\n\t\t\tthis.context.trigger(toType, this._build(event.data || {}, dataMapping));\n\t\t});\n\t}\n\n\t_build(source, mapping) {\n\t\tconst data = {...source};\n\n\t\tObject.keys(mapping).forEach((key) => {\n\t\t\tlet value = mapping[key];\n\n\t\t\tswitch (typeof value) {\n\t\t\t\tcase 'string':\n\t\t\t\t\tif (value.indexOf('.') === 0) {\n\t\t\t\t\t\tvalue = value.substr(1);\n\n\t\t\t\t\t\tif (typeof source[value] === 'function') {\n\t\t\t\t\t\t\tdata[key] = source[value].call();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdata[key] = source[value];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata[key] = value;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'function':\n\t\t\t\t\tdata[key] = value.call(this, source, mapping);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdata[key] = value;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\treturn data;\n\t}\n\n\t_onEvent(event) {\n\t\tthis.execute(event);\n\t}\n\n}\n\nexport class Registry extends EventMapper {\n\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tif (!options.trackEventType) {\n\t\t\tthrow new Error('Missing event type definition for event tracking.');\n\t\t}\n\t}\n\n\tregisterEvent(fromType, dataMapping) {\n\t\tthis.map(fromType, this.options.trackEventType, dataMapping);\n\t}\n\n}\n"],"sourceRoot":""}